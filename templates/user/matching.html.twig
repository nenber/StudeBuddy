{% extends 'base.html.twig' %}

{% block title %}Choisis ton Buddy
{% endblock %}

{% block body %}
	<div id="register">
		<div class="row register mt-sm-5">
			<div class="col-lg-12 col-sm-12" data-aos="fade-right">
				<div class="row">
					<div class="col-xl-8 col-sm-12">
						<h1>Choisis ton Buddy,
							{{ app.user.firstname }}
							{{ app.user.lastname }}
							!
							<hr></h1>
					</div>
					<div class="offset-xl-2 col-xl-2">
						{% if  ((warning == false) and (sorry == false)) %}
							<div class="row refresh">
								<div id="refresh-btn" class="col-lg-4 d-none d-lg-block align-right">
									<a class="right" type="submit" onclick="refreshPage()"><img src="{{ asset('build/images/refresh.png') }}" alt="refresh">
										Actualiser</a>
								</div>
							{% endif %}
						</div>
					</div>
					<div class="row">
						{% if warning == true %}
							<div class="alert alert-info alert-dismissible">
								<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
								<strong>Stop ! Contrôle d'identité !</strong>
								<p>
									Es-tu filleul ?
									<small>Non...</small>
									Es-tu parrain ?
									<small>Non plus...</small>
									<br>
									Donc on ne peut pas te mettre en lien avec des Buddies.<br>
									Et en plus tu ne peux pas profiter de tous les services que le site t'offre.<br>
									Reviens après avoir modifié ton
									<a href="{{ path('user_edit-profile') }}" class="alert-link">
										profil</a>
								</p>
							</div>
						{% endif %}
						{% if sorry == true and warning == false %}
							<div class="alert alert-warning alert-dismissible">
								<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
								<strong>Oops...</strong>
								<p>
									C'est un peu embarrassant mais y a personne qui correspond à ton profil.<br>
									On t'invite à modifier ton
									<a href="{{ path('user_edit-profile') }}" class="alert-link">
										profil</a>
									soit en changeant ton rôle ou bien en ajoutant des langues d'apprentissage.
								</p>
							</div>
						{% endif %}
					</div>

					<div class="matching-card row">
						<div class="col">
							<div
								class="row">
								{# a faire un sorte de while #}
								{% for item in buddies|shuffle %}
									{% if not item.isconnected %}
										{% if not item.isBanned %}
											{# {{dump(item.id)}} #}
											{% if item.id in app.user.blacklist %}
												{% else %}
													<div id="user-{{ item.id }}" class="card text-center mx-auto mr-xl-3 mr-sm-0 mr-0 mb-3">
														{% if item.imageName == null %}
															<div class="row profil-image mx-auto">
																<img src="{{ asset('build/images/profil.png') }}"/>
															</div>
														{% else %}
															<img id="pi" src="{{ vich_uploader_asset(item, 'imageFile') }}" alt="image" style="max-height:320px;max-width:320px;"/>
														{% endif %}

														<div class="card-body">
															<div class="card-title">
																<a class="name" href="{{ path('show', { 'id': item.id }) }}">
																	<h5>
																		<b>
																			{{ item.firstname}}<br>
																			{{ item.lastname}}
																		</b>
																	</h5>
																</a>
															</div>
															<div class="card-description">
																{% if  item.description == null %}
																	<p>On dirait que je n'ai pas encore description !</p>
																{% else %}
																	<p>{{ item.description}}</p>
																{% endif %}
															</div>
															<div class="center-btn">
																<button>
																	<a class="sendmessage" href="{{ path('messagerie_new_id', {'id': item.id}) }}">
																		Envoyer un message
																	</a>
																</button>
															</div>
														</div>
													</div>
											{% endif %}
										{% endif %}
									{% endif %}
								{% endfor %}
							</div>
							{% if  ((warning == false) and (sorry == false)) %}
								<div id="refresh-btn" class="row d-xl-none d-lg-block">
									<a type="submit" onclick="refreshPage()"><img src="{{ asset('build/images/refresh.png') }}" alt="refresh">
										Actualiser</a>
								</div>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</div>
	{% endblock %}
	{% block javascripts %}
		{{ encore_entry_script_tags('app') }}
		<script>

			var isoLangs = {
"ab": {
"name": "Abkhaz",
"nativeName": "аҧсуа"
},
"aa": {
"name": "Afar",
"nativeName": "Afaraf"
},
"af": {
"name": "Afrikaans",
"nativeName": "Afrikaans"
},
"ak": {
"name": "Akan",
"nativeName": "Akan"
},
"sq": {
"name": "Albanian",
"nativeName": "Shqip"
},
"am": {
"name": "Amharic",
"nativeName": "አማርኛ"
},
"ar": {
"name": "Arabic",
"nativeName": "العربية"
},
"an": {
"name": "Aragonese",
"nativeName": "Aragonés"
},
"hy": {
"name": "Armenian",
"nativeName": "Հայերեն"
},
"as": {
"name": "Assamese",
"nativeName": "অসমীয়া"
},
"av": {
"name": "Avaric",
"nativeName": "авар мацӀ, магӀарул мацӀ"
},
"ae": {
"name": "Avestan",
"nativeName": "avesta"
},
"ay": {
"name": "Aymara",
"nativeName": "aymar aru"
},
"az": {
"name": "Azerbaijani",
"nativeName": "azərbaycan dili"
},
"bm": {
"name": "Bambara",
"nativeName": "bamanankan"
},
"ba": {
"name": "Bashkir",
"nativeName": "башҡорт теле"
},
"eu": {
"name": "Basque",
"nativeName": "euskara, euskera"
},
"be": {
"name": "Belarusian",
"nativeName": "Беларуская"
},
"bn": {
"name": "Bengali",
"nativeName": "বাংলা"
},
"bh": {
"name": "Bihari",
"nativeName": "भोजपुरी"
},
"bi": {
"name": "Bislama",
"nativeName": "Bislama"
},
"bs": {
"name": "Bosnian",
"nativeName": "bosanski jezik"
},
"br": {
"name": "Breton",
"nativeName": "brezhoneg"
},
"bg": {
"name": "Bulgarian",
"nativeName": "български език"
},
"my": {
"name": "Burmese",
"nativeName": "ဗမာစာ"
},
"ca": {
"name": "Catalan; Valencian",
"nativeName": "Català"
},
"ch": {
"name": "Chamorro",
"nativeName": "Chamoru"
},
"ce": {
"name": "Chechen",
"nativeName": "нохчийн мотт"
},
"ny": {
"name": "Chichewa; Chewa; Nyanja",
"nativeName": "chiCheŵa, chinyanja"
},
"zh": {
"name": "Chinese",
"nativeName": "中文 (Zhōngwén), 汉语, 漢語"
},
"cv": {
"name": "Chuvash",
"nativeName": "чӑваш чӗлхи"
},
"kw": {
"name": "Cornish",
"nativeName": "Kernewek"
},
"co": {
"name": "Corsican",
"nativeName": "corsu, lingua corsa"
},
"cr": {
"name": "Cree",
"nativeName": "ᓀᐦᐃᔭᐍᐏᐣ"
},
"hr": {
"name": "Croatian",
"nativeName": "hrvatski"
},
"cs": {
"name": "Czech",
"nativeName": "česky, čeština"
},
"da": {
"name": "Danish",
"nativeName": "dansk"
},
"dv": {
"name": "Divehi; Dhivehi; Maldivian;",
"nativeName": "ދިވެހި"
},
"nl": {
"name": "Dutch",
"nativeName": "Nederlands, Vlaams"
},
"en": {
"name": "English",
"nativeName": "English"
},
"eo": {
"name": "Esperanto",
"nativeName": "Esperanto"
},
"et": {
"name": "Estonian",
"nativeName": "eesti, eesti keel"
},
"ee": {
"name": "Ewe",
"nativeName": "Eʋegbe"
},
"fo": {
"name": "Faroese",
"nativeName": "føroyskt"
},
"fj": {
"name": "Fijian",
"nativeName": "vosa Vakaviti"
},
"fi": {
"name": "Finnish",
"nativeName": "suomi, suomen kieli"
},
"fr": {
"name": "French",
"nativeName": "français, langue française"
},
"ff": {
"name": "Fula; Fulah; Pulaar; Pular",
"nativeName": "Fulfulde, Pulaar, Pular"
},
"gl": {
"name": "Galician",
"nativeName": "Galego"
},
"ka": {
"name": "Georgian",
"nativeName": "ქართული"
},
"de": {
"name": "German",
"nativeName": "Deutsch"
},
"el": {
"name": "Greek, Modern",
"nativeName": "Ελληνικά"
},
"gn": {
"name": "Guaraní",
"nativeName": "Avañeẽ"
},
"gu": {
"name": "Gujarati",
"nativeName": "ગુજરાતી"
},
"ht": {
"name": "Haitian; Haitian Creole",
"nativeName": "Kreyòl ayisyen"
},
"ha": {
"name": "Hausa",
"nativeName": "Hausa, هَوُسَ"
},
"he": {
"name": "Hebrew (modern)",
"nativeName": "עברית"
},
"hz": {
"name": "Herero",
"nativeName": "Otjiherero"
},
"hi": {
"name": "Hindi",
"nativeName": "हिन्दी, हिंदी"
},
"ho": {
"name": "Hiri Motu",
"nativeName": "Hiri Motu"
},
"hu": {
"name": "Hungarian",
"nativeName": "Magyar"
},
"ia": {
"name": "Interlingua",
"nativeName": "Interlingua"
},
"id": {
"name": "Indonesian",
"nativeName": "Bahasa Indonesia"
},
"ie": {
"name": "Interlingue",
"nativeName": "Originally called Occidental; then Interlingue after WWII"
},
"ga": {
"name": "Irish",
"nativeName": "Gaeilge"
},
"ig": {
"name": "Igbo",
"nativeName": "Asụsụ Igbo"
},
"ik": {
"name": "Inupiaq",
"nativeName": "Iñupiaq, Iñupiatun"
},
"io": {
"name": "Ido",
"nativeName": "Ido"
},
"is": {
"name": "Icelandic",
"nativeName": "Íslenska"
},
"it": {
"name": "Italian",
"nativeName": "Italiano"
},
"iu": {
"name": "Inuktitut",
"nativeName": "ᐃᓄᒃᑎᑐᑦ"
},
"ja": {
"name": "Japanese",
"nativeName": "日本語 (にほんご／にっぽんご)"
},
"jv": {
"name": "Javanese",
"nativeName": "basa Jawa"
},
"kl": {
"name": "Kalaallisut, Greenlandic",
"nativeName": "kalaallisut, kalaallit oqaasii"
},
"kn": {
"name": "Kannada",
"nativeName": "ಕನ್ನಡ"
},
"kr": {
"name": "Kanuri",
"nativeName": "Kanuri"
},
"ks": {
"name": "Kashmiri",
"nativeName": "कश्मीरी, كشميري‎"
},
"kk": {
"name": "Kazakh",
"nativeName": "Қазақ тілі"
},
"km": {
"name": "Khmer",
"nativeName": "ភាសាខ្មែរ"
},
"ki": {
"name": "Kikuyu, Gikuyu",
"nativeName": "Gĩkũyũ"
},
"rw": {
"name": "Kinyarwanda",
"nativeName": "Ikinyarwanda"
},
"ky": {
"name": "Kirghiz, Kyrgyz",
"nativeName": "кыргыз тили"
},
"kv": {
"name": "Komi",
"nativeName": "коми кыв"
},
"kg": {
"name": "Kongo",
"nativeName": "KiKongo"
},
"ko": {
"name": "Korean",
"nativeName": "한국어 (韓國語), 조선말 (朝鮮語)"
},
"ku": {
"name": "Kurdish",
"nativeName": "Kurdî, كوردی‎"
},
"kj": {
"name": "Kwanyama, Kuanyama",
"nativeName": "Kuanyama"
},
"la": {
"name": "Latin",
"nativeName": "latine, lingua latina"
},
"lb": {
"name": "Luxembourgish, Letzeburgesch",
"nativeName": "Lëtzebuergesch"
},
"lg": {
"name": "Luganda",
"nativeName": "Luganda"
},
"li": {
"name": "Limburgish, Limburgan, Limburger",
"nativeName": "Limburgs"
},
"ln": {
"name": "Lingala",
"nativeName": "Lingála"
},
"lo": {
"name": "Lao",
"nativeName": "ພາສາລາວ"
},
"lt": {
"name": "Lithuanian",
"nativeName": "lietuvių kalba"
},
"lu": {
"name": "Luba-Katanga",
"nativeName": ""
},
"lv": {
"name": "Latvian",
"nativeName": "latviešu valoda"
},
"gv": {
"name": "Manx",
"nativeName": "Gaelg, Gailck"
},
"mk": {
"name": "Macedonian",
"nativeName": "македонски јазик"
},
"mg": {
"name": "Malagasy",
"nativeName": "Malagasy fiteny"
},
"ms": {
"name": "Malay",
"nativeName": "bahasa Melayu, بهاس ملايو‎"
},
"ml": {
"name": "Malayalam",
"nativeName": "മലയാളം"
},
"mt": {
"name": "Maltese",
"nativeName": "Malti"
},
"mi": {
"name": "Māori",
"nativeName": "te reo Māori"
},
"mr": {
"name": "Marathi (Marāṭhī)",
"nativeName": "मराठी"
},
"mh": {
"name": "Marshallese",
"nativeName": "Kajin M̧ajeļ"
},
"mn": {
"name": "Mongolian",
"nativeName": "монгол"
},
"na": {
"name": "Nauru",
"nativeName": "Ekakairũ Naoero"
},
"nv": {
"name": "Navajo, Navaho",
"nativeName": "Diné bizaad, Dinékʼehǰí"
},
"nb": {
"name": "Norwegian Bokmål",
"nativeName": "Norsk bokmål"
},
"nd": {
"name": "North Ndebele",
"nativeName": "isiNdebele"
},
"ne": {
"name": "Nepali",
"nativeName": "नेपाली"
},
"ng": {
"name": "Ndonga",
"nativeName": "Owambo"
},
"nn": {
"name": "Norwegian Nynorsk",
"nativeName": "Norsk nynorsk"
},
"no": {
"name": "Norwegian",
"nativeName": "Norsk"
},
"ii": {
"name": "Nuosu",
"nativeName": "ꆈꌠ꒿ Nuosuhxop"
},
"nr": {
"name": "South Ndebele",
"nativeName": "isiNdebele"
},
"oc": {
"name": "Occitan",
"nativeName": "Occitan"
},
"oj": {
"name": "Ojibwe, Ojibwa",
"nativeName": "ᐊᓂᔑᓈᐯᒧᐎᓐ"
},
"cu": {
"name": "Old Church Slavonic, Church Slavic, Church Slavonic, Old Bulgarian, Old Slavonic",
"nativeName": "ѩзыкъ словѣньскъ"
},
"om": {
"name": "Oromo",
"nativeName": "Afaan Oromoo"
},
"or": {
"name": "Oriya",
"nativeName": "ଓଡ଼ିଆ"
},
"os": {
"name": "Ossetian, Ossetic",
"nativeName": "ирон æвзаг"
},
"pa": {
"name": "Panjabi, Punjabi",
"nativeName": "ਪੰਜਾਬੀ, پنجابی‎"
},
"pi": {
"name": "Pāli",
"nativeName": "पाऴि"
},
"fa": {
"name": "Persian",
"nativeName": "فارسی"
},
"pl": {
"name": "Polish",
"nativeName": "polski"
},
"ps": {
"name": "Pashto, Pushto",
"nativeName": "پښتو"
},
"pt": {
"name": "Portuguese",
"nativeName": "Português"
},
"qu": {
"name": "Quechua",
"nativeName": "Runa Simi, Kichwa"
},
"rm": {
"name": "Romansh",
"nativeName": "rumantsch grischun"
},
"rn": {
"name": "Kirundi",
"nativeName": "kiRundi"
},
"ro": {
"name": "Romanian, Moldavian, Moldovan",
"nativeName": "română"
},
"ru": {
"name": "Russian",
"nativeName": "русский язык"
},
"sa": {
"name": "Sanskrit (Saṁskṛta)",
"nativeName": "संस्कृतम्"
},
"sc": {
"name": "Sardinian",
"nativeName": "sardu"
},
"sd": {
"name": "Sindhi",
"nativeName": "सिन्धी, سنڌي، سندھی‎"
},
"se": {
"name": "Northern Sami",
"nativeName": "Davvisámegiella"
},
"sm": {
"name": "Samoan",
"nativeName": "gagana faa Samoa"
},
"sg": {
"name": "Sango",
"nativeName": "yângâ tî sängö"
},
"sr": {
"name": "Serbian",
"nativeName": "српски језик"
},
"gd": {
"name": "Scottish Gaelic; Gaelic",
"nativeName": "Gàidhlig"
},
"sn": {
"name": "Shona",
"nativeName": "chiShona"
},
"si": {
"name": "Sinhala, Sinhalese",
"nativeName": "සිංහල"
},
"sk": {
"name": "Slovak",
"nativeName": "slovenčina"
},
"sl": {
"name": "Slovene",
"nativeName": "slovenščina"
},
"so": {
"name": "Somali",
"nativeName": "Soomaaliga, af Soomaali"
},
"st": {
"name": "Southern Sotho",
"nativeName": "Sesotho"
},
"es": {
"name": "Spanish; Castilian",
"nativeName": "español, castellano"
},
"su": {
"name": "Sundanese",
"nativeName": "Basa Sunda"
},
"sw": {
"name": "Swahili",
"nativeName": "Kiswahili"
},
"ss": {
"name": "Swati",
"nativeName": "SiSwati"
},
"sv": {
"name": "Swedish",
"nativeName": "svenska"
},
"ta": {
"name": "Tamil",
"nativeName": "தமிழ்"
},
"te": {
"name": "Telugu",
"nativeName": "తెలుగు"
},
"tg": {
"name": "Tajik",
"nativeName": "тоҷикӣ, toğikī, تاجیکی‎"
},
"th": {
"name": "Thai",
"nativeName": "ไทย"
},
"ti": {
"name": "Tigrinya",
"nativeName": "ትግርኛ"
},
"bo": {
"name": "Tibetan Standard, Tibetan, Central",
"nativeName": "བོད་ཡིག"
},
"tk": {
"name": "Turkmen",
"nativeName": "Türkmen, Түркмен"
},
"tl": {
"name": "Tagalog",
"nativeName": "Wikang Tagalog, ᜏᜒᜃᜅ᜔ ᜆᜄᜎᜓᜄ᜔"
},
"tn": {
"name": "Tswana",
"nativeName": "Setswana"
},
"to": {
"name": "Tonga (Tonga Islands)",
"nativeName": "faka Tonga"
},
"tr": {
"name": "Turkish",
"nativeName": "Türkçe"
},
"ts": {
"name": "Tsonga",
"nativeName": "Xitsonga"
},
"tt": {
"name": "Tatar",
"nativeName": "татарча, tatarça, تاتارچا‎"
},
"tw": {
"name": "Twi",
"nativeName": "Twi"
},
"ty": {
"name": "Tahitian",
"nativeName": "Reo Tahiti"
},
"ug": {
"name": "Uighur, Uyghur",
"nativeName": "Uyƣurqə, ئۇيغۇرچە‎"
},
"uk": {
"name": "Ukrainian",
"nativeName": "українська"
},
"ur": {
"name": "Urdu",
"nativeName": "اردو"
},
"uz": {
"name": "Uzbek",
"nativeName": "zbek, Ўзбек, أۇزبېك‎"
},
"ve": {
"name": "Venda",
"nativeName": "Tshivenḓa"
},
"vi": {
"name": "Vietnamese",
"nativeName": "Tiếng Việt"
},
"vo": {
"name": "Volapük",
"nativeName": "Volapük"
},
"wa": {
"name": "Walloon",
"nativeName": "Walon"
},
"cy": {
"name": "Welsh",
"nativeName": "Cymraeg"
},
"wo": {
"name": "Wolof",
"nativeName": "Wollof"
},
"fy": {
"name": "Western Frisian",
"nativeName": "Frysk"
},
"xh": {
"name": "Xhosa",
"nativeName": "isiXhosa"
},
"yi": {
"name": "Yiddish",
"nativeName": "ייִדיש"
},
"yo": {
"name": "Yoruba",
"nativeName": "Yorùbá"
},
"za": {
"name": "Zhuang, Chuang",
"nativeName": "Saɯ cueŋƅ, Saw cuengh"
}
}
var arr = [];
var languages = [];
var langcode = [];
let temp1;
let temp2
for (i in isoLangs) {
arr.push([
i, isoLangs[i]
]);
}
{% for item in buddies %}
	{% if not item.isBanned %}
		{% if item.id in app.user.blacklist %}
		{% else %}
		temp1 = {{ item.languageToLearn | json_encode | raw }};
		temp2 = {{ item.spokenLanguage | json_encode | raw }};
		
			langcode.push({"id":{{ item.id }} , "dataLtl": temp1, "dataSl": temp2} );
			console.log(langcode)
		{% endif %}
	{% endif %}


{% endfor %}

langcode.forEach(function (item, index) {
let resultsLtl = arr.filter(val => item["dataLtl"].includes(val[0]))
let resultsSl = arr.filter(val => item["dataSl"].includes(val[0]))
document.getElementById("user-" + item["id"]).children[1].children[0].innerHTML += "<p> J'apprends le "
resultsLtl.forEach(function (v, i) {
if (i == resultsLtl.length - 1) 
document.getElementById("user-" + item["id"]).children[1].children[0].innerHTML += v[1].name
 else 
document.getElementById("user-" + item["id"]).children[1].children[0].innerHTML += v[1].name + ", "

})
document.getElementById("user-" + item["id"]).children[1].children[0].innerHTML += "</p>"

document.getElementById("user-" + item["id"]).children[1].children[0].innerHTML += "<p> et je parle : "
resultsSl.forEach(function (v, i) {
if (i == resultsSl.length - 1) 
document.getElementById("user-" + item["id"]).children[1].children[0].innerHTML += v[1].name
 else 
document.getElementById("user-" + item["id"]).children[1].children[0].innerHTML += v[1].name + ", "

})
document.getElementById("user-" + item["id"]).children[1].children[0].innerHTML += "</p>"

});
		</script>
	{% endblock %}
